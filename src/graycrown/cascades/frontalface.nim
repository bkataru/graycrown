## graycrown/cascades/frontalface - LBP Cascade for frontal face detection
##
## This cascade is converted from OpenCV's lbpcascade_frontalface.xml
## Window size: 24x24 pixels
## Features: 136
## Stages: 20
## Weak Classifiers: 139
##
## Usage:
## ```nim
## import graycrown
## import graycrown/cascades/frontalface
##
## # Compute integral image
## var iiData: array[imgSize, uint32]
## var ii = initIntegralImage(iiData, width, height)
## computeIntegral(img.toView, ii)
##
## # Detect faces
## var faces: array[100, Rect]
## let n = lbpDetect(frontalfaceCascade, ii, faces, 100)
## ```

import ../core

const
  FrontalfaceWindowW* = 24
  FrontalfaceWindowH* = 24
  FrontalfaceNFeatures* = 136
  FrontalfaceNWeaks* = 139
  FrontalfaceNStages* = 20

# Feature rectangles: [x, y, w, h] * nFeatures
# Extracted from OpenCV lbpcascade_frontalface.xml <features> section
const frontalfaceFeatures*: array[136 * 4, int8] = [
  # Feature 0: rect 0 0 3 5
  0'i8, 0, 3, 5,
  # Feature 1: rect 0 0 4 2
  0'i8, 0, 4, 2,
  # Feature 2: rect 0 0 6 3
  0'i8, 0, 6, 3,
  # Feature 3: rect 0 1 2 3
  0'i8, 1, 2, 3,
  # Feature 4: rect 0 1 3 3
  0'i8, 1, 3, 3,
  # Feature 5: rect 0 1 3 7
  0'i8, 1, 3, 7,
  # Feature 6: rect 0 4 3 3
  0'i8, 4, 3, 3,
  # Feature 7: rect 0 11 3 4
  0'i8, 11, 3, 4,
  # Feature 8: rect 0 12 8 4
  0'i8, 12, 8, 4,
  # Feature 9: rect 0 14 4 3
  0'i8, 14, 4, 3,
  # Feature 10: rect 1 0 5 3
  1'i8, 0, 5, 3,
  # Feature 11: rect 1 1 2 2
  1'i8, 1, 2, 2,
  # Feature 12: rect 1 3 3 1
  1'i8, 3, 3, 1,
  # Feature 13: rect 1 7 4 4
  1'i8, 7, 4, 4,
  # Feature 14: rect 1 12 2 2
  1'i8, 12, 2, 2,
  # Feature 15: rect 1 13 4 1
  1'i8, 13, 4, 1,
  # Feature 16: rect 1 14 4 3
  1'i8, 14, 4, 3,
  # Feature 17: rect 1 17 3 2
  1'i8, 17, 3, 2,
  # Feature 18: rect 2 0 2 3
  2'i8, 0, 2, 3,
  # Feature 19: rect 2 1 2 2
  2'i8, 1, 2, 2,
  # Feature 20: rect 2 2 4 6
  2'i8, 2, 4, 6,
  # Feature 21: rect 2 3 4 4
  2'i8, 3, 4, 4,
  # Feature 22: rect 2 7 2 1
  2'i8, 7, 2, 1,
  # Feature 23: rect 2 11 2 3
  2'i8, 11, 2, 3,
  # Feature 24: rect 2 17 3 2
  2'i8, 17, 3, 2,
  # Feature 25: rect 3 0 2 2
  3'i8, 0, 2, 2,
  # Feature 26: rect 3 1 7 3
  3'i8, 1, 7, 3,
  # Feature 27: rect 3 7 2 1
  3'i8, 7, 2, 1,
  # Feature 28: rect 3 7 2 4
  3'i8, 7, 2, 4,
  # Feature 29: rect 3 18 2 2
  3'i8, 18, 2, 2,
  # Feature 30: rect 4 0 2 3
  4'i8, 0, 2, 3,
  # Feature 31: rect 4 3 2 1
  4'i8, 3, 2, 1,
  # Feature 32: rect 4 6 2 1
  4'i8, 6, 2, 1,
  # Feature 33: rect 4 6 2 5
  4'i8, 6, 2, 5,
  # Feature 34: rect 4 7 5 2
  4'i8, 7, 5, 2,
  # Feature 35: rect 4 8 4 3
  4'i8, 8, 4, 3,
  # Feature 36: rect 4 18 2 2
  4'i8, 18, 2, 2,
  # Feature 37: rect 5 0 2 2
  5'i8, 0, 2, 2,
  # Feature 38: rect 5 3 4 4
  5'i8, 3, 4, 4,
  # Feature 39: rect 5 6 2 5
  5'i8, 6, 2, 5,
  # Feature 40: rect 5 9 2 2
  5'i8, 9, 2, 2,
  # Feature 41: rect 5 10 2 2
  5'i8, 10, 2, 2,
  # Feature 42: rect 6 3 4 4
  6'i8, 3, 4, 4,
  # Feature 43: rect 6 4 4 3
  6'i8, 4, 4, 3,
  # Feature 44: rect 6 5 2 3
  6'i8, 5, 2, 3,
  # Feature 45: rect 6 5 2 5
  6'i8, 5, 2, 5,
  # Feature 46: rect 6 5 4 3
  6'i8, 5, 4, 3,
  # Feature 47: rect 6 6 4 2
  6'i8, 6, 4, 2,
  # Feature 48: rect 6 6 4 4
  6'i8, 6, 4, 4,
  # Feature 49: rect 6 18 1 2
  6'i8, 18, 1, 2,
  # Feature 50: rect 6 21 2 1
  6'i8, 21, 2, 1,
  # Feature 51: rect 7 0 3 7
  7'i8, 0, 3, 7,
  # Feature 52: rect 7 4 2 3
  7'i8, 4, 2, 3,
  # Feature 53: rect 7 9 5 1
  7'i8, 9, 5, 1,
  # Feature 54: rect 7 21 2 1
  7'i8, 21, 2, 1,
  # Feature 55: rect 8 0 1 4
  8'i8, 0, 1, 4,
  # Feature 56: rect 8 5 2 2
  8'i8, 5, 2, 2,
  # Feature 57: rect 8 5 3 2
  8'i8, 5, 3, 2,
  # Feature 58: rect 8 17 3 1
  8'i8, 17, 3, 1,
  # Feature 59: rect 8 18 1 2
  8'i8, 18, 1, 2,
  # Feature 60: rect 9 0 5 3
  9'i8, 0, 5, 3,
  # Feature 61: rect 9 2 2 6
  9'i8, 2, 2, 6,
  # Feature 62: rect 9 5 1 1
  9'i8, 5, 1, 1,
  # Feature 63: rect 9 11 1 1
  9'i8, 11, 1, 1,
  # Feature 64: rect 9 16 1 1
  9'i8, 16, 1, 1,
  # Feature 65: rect 9 16 2 1
  9'i8, 16, 2, 1,
  # Feature 66: rect 9 17 1 1
  9'i8, 17, 1, 1,
  # Feature 67: rect 9 18 1 1
  9'i8, 18, 1, 1,
  # Feature 68: rect 10 5 1 2
  10'i8, 5, 1, 2,
  # Feature 69: rect 10 5 3 3
  10'i8, 5, 3, 3,
  # Feature 70: rect 10 7 1 5
  10'i8, 7, 1, 5,
  # Feature 71: rect 10 8 1 1
  10'i8, 8, 1, 1,
  # Feature 72: rect 10 9 1 1
  10'i8, 9, 1, 1,
  # Feature 73: rect 10 10 1 1
  10'i8, 10, 1, 1,
  # Feature 74: rect 10 10 1 2
  10'i8, 10, 1, 2,
  # Feature 75: rect 10 14 3 3
  10'i8, 14, 3, 3,
  # Feature 76: rect 10 15 1 1
  10'i8, 15, 1, 1,
  # Feature 77: rect 10 15 2 1
  10'i8, 15, 2, 1,
  # Feature 78: rect 10 16 1 1
  10'i8, 16, 1, 1,
  # Feature 79: rect 10 16 2 1
  10'i8, 16, 2, 1,
  # Feature 80: rect 10 17 1 1
  10'i8, 17, 1, 1,
  # Feature 81: rect 10 21 1 1
  10'i8, 21, 1, 1,
  # Feature 82: rect 11 3 2 2
  11'i8, 3, 2, 2,
  # Feature 83: rect 11 5 1 2
  11'i8, 5, 1, 2,
  # Feature 84: rect 11 5 3 3
  11'i8, 5, 3, 3,
  # Feature 85: rect 11 5 4 6
  11'i8, 5, 4, 6,
  # Feature 86: rect 11 6 1 1
  11'i8, 6, 1, 1,
  # Feature 87: rect 11 7 2 2
  11'i8, 7, 2, 2,
  # Feature 88: rect 11 8 1 2
  11'i8, 8, 1, 2,
  # Feature 89: rect 11 10 1 1
  11'i8, 10, 1, 1,
  # Feature 90: rect 11 10 1 2
  11'i8, 10, 1, 2,
  # Feature 91: rect 11 15 1 1
  11'i8, 15, 1, 1,
  # Feature 92: rect 11 17 1 1
  11'i8, 17, 1, 1,
  # Feature 93: rect 11 18 1 1
  11'i8, 18, 1, 1,
  # Feature 94: rect 12 0 2 2
  12'i8, 0, 2, 2,
  # Feature 95: rect 12 1 2 5
  12'i8, 1, 2, 5,
  # Feature 96: rect 12 2 4 1
  12'i8, 2, 4, 1,
  # Feature 97: rect 12 3 1 3
  12'i8, 3, 1, 3,
  # Feature 98: rect 12 7 3 4
  12'i8, 7, 3, 4,
  # Feature 99: rect 12 10 3 2
  12'i8, 10, 3, 2,
  # Feature 100: rect 12 11 1 1
  12'i8, 11, 1, 1,
  # Feature 101: rect 12 12 3 2
  12'i8, 12, 3, 2,
  # Feature 102: rect 12 14 4 3
  12'i8, 14, 4, 3,
  # Feature 103: rect 12 17 1 1
  12'i8, 17, 1, 1,
  # Feature 104: rect 12 21 2 1
  12'i8, 21, 2, 1,
  # Feature 105: rect 13 6 2 5
  13'i8, 6, 2, 5,
  # Feature 106: rect 13 7 3 5
  13'i8, 7, 3, 5,
  # Feature 107: rect 13 11 3 2
  13'i8, 11, 3, 2,
  # Feature 108: rect 13 17 2 2
  13'i8, 17, 2, 2,
  # Feature 109: rect 13 17 3 2
  13'i8, 17, 3, 2,
  # Feature 110: rect 13 18 1 2
  13'i8, 18, 1, 2,
  # Feature 111: rect 13 18 2 2
  13'i8, 18, 2, 2,
  # Feature 112: rect 14 0 2 2
  14'i8, 0, 2, 2,
  # Feature 113: rect 14 1 1 3
  14'i8, 1, 1, 3,
  # Feature 114: rect 14 2 3 2
  14'i8, 2, 3, 2,
  # Feature 115: rect 14 7 2 1
  14'i8, 7, 2, 1,
  # Feature 116: rect 14 13 2 1
  14'i8, 13, 2, 1,
  # Feature 117: rect 14 13 3 3
  14'i8, 13, 3, 3,
  # Feature 118: rect 14 17 2 2
  14'i8, 17, 2, 2,
  # Feature 119: rect 15 0 2 2
  15'i8, 0, 2, 2,
  # Feature 120: rect 15 0 2 3
  15'i8, 0, 2, 3,
  # Feature 121: rect 15 4 3 2
  15'i8, 4, 3, 2,
  # Feature 122: rect 15 4 3 6
  15'i8, 4, 3, 6,
  # Feature 123: rect 15 6 3 2
  15'i8, 6, 3, 2,
  # Feature 124: rect 15 11 3 4
  15'i8, 11, 3, 4,
  # Feature 125: rect 15 13 3 2
  15'i8, 13, 3, 2,
  # Feature 126: rect 15 17 2 2
  15'i8, 17, 2, 2,
  # Feature 127: rect 15 17 3 2
  15'i8, 17, 3, 2,
  # Feature 128: rect 16 1 2 3
  16'i8, 1, 2, 3,
  # Feature 129: rect 16 3 2 4
  16'i8, 3, 2, 4,
  # Feature 130: rect 16 6 1 1
  16'i8, 6, 1, 1,
  # Feature 131: rect 16 16 2 2
  16'i8, 16, 2, 2,
  # Feature 132: rect 17 1 2 2
  17'i8, 1, 2, 2,
  # Feature 133: rect 17 1 2 5
  17'i8, 1, 2, 5,
  # Feature 134: rect 17 12 2 2
  17'i8, 12, 2, 2,
  # Feature 135: rect 18 0 2 2
  18'i8, 0, 2, 2,
]

# Stage thresholds
const frontalfaceStageThreshold*: array[20, float32] = [
  -0.7520892024040222'f32,
  -0.4872078299522400'f32,
  -1.1592328548431396'f32,
  -0.7562355995178223'f32,
  -0.8085358142852783'f32,
  -0.5549971461296082'f32,
  -0.8776460289955139'f32,
  -1.1139287948608398'f32,
  -0.8243625760078430'f32,
  -1.2237116098403931'f32,
  -0.5544230937957764'f32,
  -0.7161560654640198'f32,
  -0.6743940711021423'f32,
  -1.2042298316955566'f32,
  -0.8402050137519836'f32,
  -1.1974394321441650'f32,
  -0.5733128190040588'f32,
  -0.4892596900463104'f32,
  -0.5911940932273865'f32,
  -0.7612916231155396'f32,
]

# Number of weak classifiers per stage
const frontalfaceStageNWeaks*: array[20, uint16] = [
  3'u16, 4, 4, 5, 5, 5, 5, 6, 7, 7, 7, 7, 8, 9, 10, 9, 9, 9, 10, 10
]

# Stage weak classifier start indices
const frontalfaceStageWeakStart*: array[20, uint16] = [
  0'u16, 3, 7, 11, 16, 21, 26, 31, 37, 44, 51, 58, 65, 73, 82, 92, 101, 110, 119, 129
]

# Weak classifier feature indices (139 entries)
# Extracted from internalNodes field: 0 -1 <featureIdx> ...
const frontalfaceWeakFeatureIdx*: array[139, uint16] = [
  # Stage 0 (3 weaks)
  46'u16, 13, 2,
  # Stage 1 (4 weaks)
  84'u16, 21, 106, 48,
  # Stage 2 (4 weaks)
  47'u16, 12, 26, 8,
  # Stage 3 (5 weaks)
  96'u16, 33, 57, 125, 53,
  # Stage 4 (5 weaks)
  60'u16, 7, 98, 44, 24,
  # Stage 5 (5 weaks)
  42'u16, 6, 61, 123, 9,
  # Stage 6 (5 weaks)
  105'u16, 30, 35, 119, 82,
  # Stage 7 (6 weaks)
  52'u16, 99, 18, 111, 92, 51,
  # Stage 8 (7 weaks)
  28'u16, 112, 69, 19, 73, 126, 45,
  # Stage 9 (7 weaks)
  114'u16, 97, 25, 34, 134, 16, 74,
  # Stage 10 (7 weaks)
  113'u16, 110, 37, 41, 117, 65, 56,
  # Stage 11 (7 weaks)
  20'u16, 15, 129, 102, 88, 59, 27,
  # Stage 12 (8 weaks)
  29'u16, 128, 70, 4, 76, 124, 54, 95,
  # Stage 13 (9 weaks)
  39'u16, 120, 89, 14, 67, 86, 80, 75, 55,
  # Stage 14 (10 weaks)
  71'u16, 31, 40, 109, 130, 66, 49, 133, 0, 103,
  # Stage 15 (9 weaks)
  43'u16, 90, 104, 85, 24, 78, 5, 11, 32,
  # Stage 16 (9 weaks)
  122'u16, 68, 58, 94, 87, 127, 3, 79, 116,
  # Stage 17 (9 weaks)
  132'u16, 62, 23, 77, 22, 72, 50, 108, 92,
  # Stage 18 (10 weaks)
  81'u16, 1, 121, 38, 17, 100, 63, 101, 118, 92,
  # Stage 19 (10 weaks)
  10'u16, 131, 83, 135, 115, 64, 36, 93, 91, 107,
]

# Weak classifier left values (match case)
const frontalfaceWeakLeftVal*: array[139, float32] = [
  # Stage 0
  -0.6543210148811340'f32, -0.7739216089248657'f32, -0.7068563103675842'f32,
  # Stage 1
  -0.8083735704421997'f32, -0.7698410153388977'f32, -0.7506558895111084'f32, -0.7775990366935730'f32,
  # Stage 2
  -0.5601882934570313'f32, -0.6124526262283325'f32, -0.6114496588706970'f32, -0.6854077577590942'f32,
  # Stage 3
  -0.4051094949245453'f32, -0.7388162612915039'f32, -0.6582943797111511'f32, -0.5981323719024658'f32, -0.6498787999153137'f32,
  # Stage 4
  -0.5278195738792419'f32, -0.5206505060195923'f32, -0.7516061067581177'f32, -0.7639313936233521'f32, -0.5123769044876099'f32,
  # Stage 5
  -0.3763174116611481'f32, -0.5352765917778015'f32, -0.5678374171257019'f32, -0.5706262588500977'f32, -0.5344601869583130'f32,
  # Stage 6
  -0.7700348496437073'f32, -0.5043668746948242'f32, -0.6808040738105774'f32, -0.4927591383457184'f32, -0.6445107460021973'f32,
  # Stage 7
  -0.5307556986808777'f32, -0.5227634310722351'f32, -0.4983572661876679'f32, -0.4990860521793366'f32, -0.5695009231567383'f32, -0.6590405106544495'f32,
  # Stage 8
  -0.4972776770591736'f32, -0.4383158981800079'f32, -0.6386105418205261'f32, -0.5512794256210327'f32, -0.6418755054473877'f32, -0.4841901361942291'f32, -0.5855734348297119'f32,
  # Stage 9
  -0.2518476545810700'f32, -0.4303432404994965'f32, -0.4259553551673889'f32, -0.5605589151382446'f32, -0.5192656517028809'f32, -0.5013077259063721'f32, -0.4631414115428925'f32,
  # Stage 10
  -0.3949716091156006'f32, -0.4855885505676270'f32, -0.4620285332202911'f32, -0.6420643329620361'f32, -0.4820112884044647'f32, -0.4465552568435669'f32, -0.5190586447715759'f32,
  # Stage 11
  -0.4323809444904327'f32, -0.4588732719421387'f32, -0.5218553543090820'f32, -0.4920000731945038'f32, -0.4494568109512329'f32, -0.5180826783180237'f32, -0.6081240773200989'f32,
  # Stage 12
  -0.1790193915367127'f32, -0.3681024610996246'f32, -0.3217232525348663'f32, -0.4373284578323364'f32, -0.4404836893081665'f32, -0.4294152259826660'f32, -0.3973052501678467'f32, -0.7054683566093445'f32,
  # Stage 13
  -0.5905947685241699'f32, -0.4449204802513123'f32, -0.4693818688392639'f32, -0.3600351214408875'f32, -0.4459891915321350'f32, -0.4466069042682648'f32, -0.3394956290721893'f32, -0.5346512198448181'f32, -0.4379335641860962'f32,
  # Stage 14
  -0.2670986354351044'f32, -0.4149844348430634'f32, -0.4985891580581665'f32, -0.4568729996681213'f32, -0.4770836830139160'f32, -0.4877715110778809'f32, -0.3721654713153839'f32, -0.3934195041656494'f32, -0.4323300719261169'f32, -0.4993278682231903'f32,
  # Stage 15
  -0.3310225307941437'f32, -0.5266560912132263'f32, -0.4171888828277588'f32, -0.4556705355644226'f32, -0.4182529747486115'f32, -0.3625369668006897'f32, -0.4742925167083740'f32, -0.3666271567344666'f32, -0.4567637443542481'f32,
  # Stage 16
  -0.4055117964744568'f32, -0.3787897229194641'f32, -0.4258328974246979'f32, -0.4561023116111755'f32, -0.4314672648906708'f32, -0.4174543321132660'f32, -0.4321364760398865'f32, -0.5018386244773865'f32, -0.5037505626678467'f32,
  # Stage 17
  -0.2448196411132813'f32, -0.4633283913135529'f32, -0.3731099069118500'f32, -0.3658909499645233'f32, -0.5214384198188782'f32, -0.4289036989212036'f32, -0.4621542394161224'f32, -0.3711548447608948'f32, -0.5180652141571045'f32,
  # Stage 18
  -0.2592592537403107'f32, -0.3801195919513702'f32, -0.3509117066860199'f32, -0.4068757295608521'f32, -0.4557141065597534'f32, -0.4117803275585175'f32, -0.4008397758007050'f32, -0.5694189667701721'f32, -0.3195341229438782'f32, -0.3365339040756226'f32,
  # Stage 19
  -0.4204545319080353'f32, -0.3762553930282593'f32, -0.4253497421741486'f32, -0.3601998090744019'f32, -0.4034293889999390'f32, -0.3620899617671967'f32, -0.3903816640377045'f32, -0.3591445386409760'f32, -0.4297670423984528'f32, -0.5727006793022156'f32,
]

# Weak classifier right values (no match case)
const frontalfaceWeakRightVal*: array[139, float32] = [
  # Stage 0
  0.8888888955116272'f32, 0.7278633713722229'f32, 0.6761534214019775'f32,
  # Stage 1
  0.7685696482658386'f32, 0.6592915654182434'f32, 0.5444605946540833'f32, 0.5465461611747742'f32,
  # Stage 2
  0.7743113040924072'f32, 0.6978127956390381'f32, 0.6537628173828125'f32, 0.5403239130973816'f32,
  # Stage 3
  0.7584033608436585'f32, 0.5340843200683594'f32, 0.5339496731758118'f32, 0.5323504805564880'f32, 0.4913350641727448'f32,
  # Stage 4
  0.6946372389793396'f32, 0.6329920291900635'f32, 0.4232024252414703'f32, 0.4123568832874298'f32, 0.5791834592819214'f32,
  # Stage 5
  0.7298233509063721'f32, 0.5659480094909668'f32, 0.4961479902267456'f32, 0.4572288393974304'f32, 0.4672054052352905'f32,
  # Stage 6
  0.5943940877914429'f32, 0.6151274442672730'f32, 0.4667325913906097'f32, 0.5401885509490967'f32, 0.4227822124958038'f32,
  # Stage 7
  0.6258179545402527'f32, 0.5049746036529541'f32, 0.5106441378593445'f32, 0.5060507059097290'f32, 0.4460467398166657'f32, 0.3616424500942230'f32,
  # Stage 8
  0.6027074456214905'f32, 0.5966237187385559'f32, 0.3977999985218048'f32, 0.4282079637050629'f32, 0.3549866080284119'f32, 0.4668019413948059'f32, 0.3879135847091675'f32,
  # Stage 9
  0.7088654041290283'f32, 0.5283288359642029'f32, 0.5440809130668640'f32, 0.4220733344554901'f32, 0.4399855434894562'f32, 0.4570254683494568'f32, 0.4790246188640595'f32,
  # Stage 10
  0.6082032322883606'f32, 0.4785369932651520'f32, 0.4989669024944305'f32, 0.3624351918697357'f32, 0.4632140696048737'f32, 0.5061788558959961'f32, 0.4441480338573456'f32,
  # Stage 11
  0.5663768053054810'f32, 0.4547033011913300'f32, 0.4111092388629913'f32, 0.4326725304126740'f32, 0.4448510706424713'f32, 0.3888972699642181'f32, 0.3333222270011902'f32,
  # Stage 12
  0.6605972051620483'f32, 0.5139749646186829'f32, 0.6171553134918213'f32, 0.4358185231685638'f32, 0.4601220190525055'f32, 0.4452161788940430'f32, 0.4854526817798615'f32, 0.2697997391223908'f32,
  # Stage 13
  0.5101932883262634'f32, 0.4490709304809570'f32, 0.4061094820499420'f32, 0.5056326985359192'f32, 0.4132415652275085'f32, 0.4135067760944367'f32, 0.5658645033836365'f32, 0.3584479391574860'f32, 0.4123645126819611'f32,
  # Stage 14
  0.6014143228530884'f32, 0.4670888185501099'f32, 0.3719584941864014'f32, 0.3965812027454376'f32, 0.3862601518630981'f32, 0.3778986334800720'f32, 0.4994400143623352'f32, 0.4769641458988190'f32, 0.4342164099216461'f32, 0.3665378093719482'f32,
  # Stage 15
  0.5624626278877258'f32, 0.3704403042793274'f32, 0.4540435671806335'f32, 0.3704262077808380'f32, 0.4267231225967407'f32, 0.4684656262397766'f32, 0.3689507246017456'f32, 0.4580127298831940'f32, 0.3894708156585693'f32,
  # Stage 16
  0.5487945079803467'f32, 0.4532003402709961'f32, 0.4202791750431061'f32, 0.4002747833728790'f32, 0.4086346626281738'f32, 0.4249868988990784'f32, 0.4090838730335236'f32, 0.3702533841133118'f32, 0.3564981222152710'f32,
  # Stage 17
  0.5689709186553955'f32, 0.3587929606437683'f32, 0.4290455579757690'f32, 0.4556473195552826'f32, 0.3221037387847900'f32, 0.4004956185817719'f32, 0.3832748532295227'f32, 0.4612701535224915'f32, 0.3205870389938355'f32,
  # Stage 18
  0.5873016119003296'f32, 0.4718827307224274'f32, 0.5094807147979736'f32, 0.4130136370658875'f32, 0.3539792001247406'f32, 0.4118592441082001'f32, 0.4034757018089294'f32, 0.2964762747287750'f32, 0.5294018983840942'f32, 0.5067458748817444'f32,
  # Stage 19
  0.5165745615959168'f32, 0.4075302779674530'f32, 0.3728055357933044'f32, 0.4563256204128265'f32, 0.4160816967487335'f32, 0.4594142735004425'f32, 0.4381459355354309'f32, 0.4624078869819641'f32, 0.4023293554782867'f32, 0.2995934784412384'f32,
]

# Weak classifier subset offsets (each weak uses 8 int32s = 256 bits for LBP lookup)
const frontalfaceWeakSubsetOffset*: array[139, uint16] = [
  0'u16, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152,
  160'u16, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312,
  320'u16, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472,
  480'u16, 488, 496, 504, 512, 520, 528, 536, 544, 552, 560, 568, 576, 584, 592, 600, 608, 616, 624, 632,
  640'u16, 648, 656, 664, 672, 680, 688, 696, 704, 712, 720, 728, 736, 744, 752, 760, 768, 776, 784, 792,
  800'u16, 808, 816, 824, 832, 840, 848, 856, 864, 872, 880, 888, 896, 904, 912, 920, 928, 936, 944, 952,
  960'u16, 968, 976, 984, 992, 1000, 1008, 1016, 1024, 1032, 1040, 1048, 1056, 1064, 1072, 1080, 1088, 1096, 1104,
]

# Number of subsets per weak (always 8 for LBP - 8 * 32 bits = 256 bit lookup table)
const frontalfaceWeakNumSubsets*: array[139, uint16] = [
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
  8'u16, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
]

# LBP subset bitmasks (139 weak classifiers * 8 int32s each = 1112 entries)
# Each group of 8 int32s forms a 256-bit lookup table for the LBP code
const frontalfaceSubsets*: array[1112, int32] = [
  # Weak 0 (stage 0, feature 46)
  -67130709'i32, -21569, -1426120013, -1275125205, -21585, -16385, 587145899, -24005,
  # Weak 1 (stage 0, feature 13)
  -163512766'i32, -769593758, -10027009, -262145, -514457854, -193593353, -524289, -1,
  # Weak 2 (stage 0, feature 2)
  -363936790'i32, -893203669, -1337948010, -136907894, 1088782736, -134217726, -741544961, -1590337,
  # Weak 3 (stage 1, feature 84)
  2147483647'i32, 1946124287, -536870913, 2147450879, 738132490, 1061101567, 243204619, 2147446655,
  # Weak 4 (stage 1, feature 21)
  2147483647'i32, 263176079, 1879048191, 254749487, 1879048191, -134252545, -268435457, 801111999,
  # Weak 5 (stage 1, feature 106)
  -98110272'i32, 1610939566, -285484400, -850010381, -189334372, -1671954433, -571026695, -262145,
  # Weak 6 (stage 1, feature 48)
  -798690576'i32, -131075, 1095771153, -237144073, -65569, -1, -216727745, -69206049,
  # Weak 7 (stage 2, feature 47)
  -21585'i32, -20549, -100818262, -738254174, -20561, -36865, -151016790, -134238549,
  # Weak 8 (stage 2, feature 12)
  -286003217'i32, 183435247, -268994614, -421330945, -402686081, 1090387966, -286785545, -402653185,
  # Weak 9 (stage 2, feature 26)
  -50347012'i32, 970882927, -50463492, -1253377, -134218251, -50364513, -33619992, -172490753,
  # Weak 10 (stage 2, feature 8)
  -273'i32, -135266321, 1877977738, -2088243418, -134217987, 2146926575, -18910642, 1095231247,
  # Weak 11 (stage 3, feature 96)
  -1273'i32, 1870659519, -20971602, -67633153, -134250731, 2004875127, -250, -150995969,
  # Weak 12 (stage 3, feature 33)
  -868162224'i32, -76810262, -4262145, -257, 1465211989, -268959873, -2656269, -524289,
  # Weak 13 (stage 3, feature 57)
  -12817'i32, -49, -541103378, -152950, -38993, -20481, -1153876, -72478976,
  # Weak 14 (stage 3, feature 125)
  -269484161'i32, -452984961, -319816180, -1594032130, -2111, -990117891, -488975296, -520947741,
  # Weak 15 (stage 3, feature 53)
  557787431'i32, 670265215, -1342193665, -1075892225, 1998528318, 1056964607, -33570977, -1,
  # Weak 16 (stage 4, feature 60)
  -536873708'i32, 880195381, -16842788, -20971521, -176687276, -168427659, -16777260, -33554626,
  # Weak 17 (stage 4, feature 7)
  -1'i32, -62981529, -1090591130, 805330978, -8388827, -41945787, -39577, -531118985,
  # Weak 18 (stage 4, feature 98)
  -725287348'i32, 1347747543, -852489, -16809993, 1489881036, -167903241, -1, -1,
  # Weak 19 (stage 4, feature 44)
  -32777'i32, 1006582562, -65, 935312171, -8388609, -1078198273, -1, 733886267,
  # Weak 20 (stage 4, feature 24)
  -85474705'i32, 2138828511, -1036436754, 817625855, 1123369029, -58796809, -1013468481, -194513409,
  # Weak 21 (stage 5, feature 42)
  -17409'i32, -20481, -268457797, -134239493, -17473, -1, -21829, -21846,
  # Weak 22 (stage 5, feature 6)
  -805310737'i32, -2098262358, -269504725, 682502698, 2147483519, 1740574719, -1090519233, -268472385,
  # Weak 23 (stage 5, feature 61)
  -67109678'i32, -6145, -8, -87884584, -20481, -1073762305, -50856216, -16849696,
  # Weak 24 (stage 5, feature 123)
  -138428633'i32, 1002418167, -1359008245, -1908670465, -1346685918, 910098423, -1359010520, -1346371657,
  # Weak 25 (stage 5, feature 9)
  -89138513'i32, -4196353, 1256531674, -1330665426, 1216308261, -36190633, 33498198, -151796633,
  # Weak 26 (stage 6, feature 105)
  1073769576'i32, 206601725, -34013449, -33554433, -789514004, -101384321, -690225153, -264193,
  # Weak 27 (stage 6, feature 30)
  -1432340997'i32, -823623681, -49153, -34291724, -269484035, -1342767105, -1078198273, -1277955,
  # Weak 28 (stage 6, feature 35)
  -1067385040'i32, -195758209, -436748425, -134217731, -50855988, -129, -1, -1,
  # Weak 29 (stage 6, feature 119)
  832534325'i32, -34111555, -26050561, -423659521, -268468364, 2105014143, -2114244, -17367185,
  # Weak 30 (stage 6, feature 82)
  -1089439888'i32, -1080524865, 2143059967, -1114121, -1140949004, -3, -2361356, -739516,
  # Weak 31 (stage 7, feature 52)
  -1074071553'i32, -1074003969, -1, -1280135430, -5324817, -1, -335548482, 582134442,
  # Weak 32 (stage 7, feature 99)
  -706937396'i32, -705364068, -540016724, -570495027, -570630659, -587857963, -33628164, -35848193,
  # Weak 33 (stage 7, feature 18)
  -2035630093'i32, 42119158, -268503053, -1671444, 261017599, 1325432815, 1954394111, -805306449,
  # Weak 34 (stage 7, feature 111)
  -282529488'i32, -1558073088, 1426018736, -170526448, -546832487, -5113037, -34243375, -570427929,
  # Weak 35 (stage 7, feature 92)
  1016332500'i32, -606301707, 915094269, -1080086049, -1837027144, -1361600280, 2147318747, 1067975613,
  # Weak 36 (stage 7, feature 51)
  -656420166'i32, -15413034, -141599534, -603435836, 1505950458, -787556946, -79823438, -1326199134,
  # Weak 37 (stage 8, feature 28)
  -901591776'i32, -201916417, -262, -67371009, -143312112, -524289, -41943178, -1,
  # Weak 38 (stage 8, feature 112)
  -4507851'i32, -411340929, -268437513, -67502145, -17350859, -32901, -71344315, -29377,
  # Weak 39 (stage 8, feature 69)
  -75894785'i32, -117379438, -239063587, -12538500, 1485072126, 2076233213, 2123118847, 801906927,
  # Weak 40 (stage 8, feature 19)
  -823480413'i32, 786628589, -16876049, -1364262914, 242165211, 1315930109, -696268833, -455082829,
  # Weak 41 (stage 8, feature 73)
  -521411968'i32, 6746762, -1396236286, -2038436114, -185612509, 57669627, -143132877, -1041235973,
  # Weak 42 (stage 8, feature 126)
  -478153869'i32, 1076028979, -1645895615, 1365298272, -557859073, -339771473, 1442574528, -1058802061,
  # Weak 43 (stage 8, feature 45)
  -246350404'i32, -1650402048, -1610612745, -788400696, 1467604861, -2787397, 1476263935, -4481349,
  # Weak 44 (stage 9, feature 114)
  -24819'i32, 1572863935, -16809993, -67108865, 2146778388, 1433927541, -268608444, -34865205,
  # Weak 45 (stage 9, feature 97)
  -1841359'i32, -134271049, -32769, -5767369, -1116675, -2185, -8231, -33603327,
  # Weak 46 (stage 9, feature 25)
  -1359507589'i32, -1360593090, -1073778729, -269553812, -809512977, 1744707583, -41959433, -134758978,
  # Weak 47 (stage 9, feature 34)
  729753407'i32, -134270989, -1140907329, -235200777, 658456383, 2147467263, -1140900929, -16385,
  # Weak 48 (stage 9, feature 134)
  -310380553'i32, -420675595, -193005472, -353568129, 1205338070, -990380036, 887604324, -420544526,
  # Weak 49 (stage 9, feature 16)
  -1427119361'i32, 1978920959, -287119734, -487068946, 114759245, -540578051, -707510259, -671660453,
  # Weak 50 (stage 9, feature 74)
  -738463762'i32, -889949281, -328301948, -121832450, -1142658284, -1863576559, 2146417353, -263185,
  # Weak 51 (stage 10, feature 113)
  -76228780'i32, -65538, -1, -67174401, -148007, -33, -221796, -272842924,
  # Weak 52 (stage 10, feature 110)
  369147696'i32, -1625232112, 2138570036, -1189900, 790708019, -1212613127, 799948719, -4456483,
  # Weak 53 (stage 10, feature 37)
  784215839'i32, -290015241, 536832799, -402984963, -1342414991, -838864897, -176769, -268456129,
  # Weak 54 (stage 10, feature 41)
  -486418688'i32, -171915327, -340294900, -21938, -519766032, -772751172, -73096060, -585322623,
  # Weak 55 (stage 10, feature 117)
  -33554953'i32, -475332625, -1423463824, -2077230421, -4849669, -2080505925, -219032928, -1071915349,
  # Weak 56 (stage 10, feature 65)
  -834130468'i32, -134217476, -1349314083, -1073803559, -619913764, -1449131844, -1386890321, -1979118423,
  # Weak 57 (stage 10, feature 56)
  -285249779'i32, 1912569855, -16530, -1731022870, -1161904146, -1342177297, -268439634, -1464078708,
  # Weak 58 (stage 11, feature 20)
  1246232575'i32, 1078001186, -10027057, 60102, -277348353, -43646987, -1210581153, 1195769615,
  # Weak 59 (stage 11, feature 15)
  -778583572'i32, -612921106, -578775890, -4036478, -1946580497, -1164766570, -1986687009, -12103599,
  # Weak 60 (stage 11, feature 129)
  -1073759445'i32, 2013231743, -1363169553, -1082459201, -1414286549, 868185983, -1356133589, -1077936257,
  # Weak 61 (stage 11, feature 102)
  -84148365'i32, -2093417722, -1204850272, 564290299, -67121221, -1342177350, -1309195902, -776734797,
  # Weak 62 (stage 11, feature 88)
  -25694458'i32, 67104495, -290216278, -168563037, 2083877442, 1702788383, -144191964, -234882162,
  # Weak 63 (stage 11, feature 59)
  -857980836'i32, 904682741, -1612267521, 232279415, 1550862252, -574825221, -357380888, -4579409,
  # Weak 64 (stage 11, feature 27)
  -98549440'i32, -137838400, 494928389, -246013630, 939541351, -1196072350, -620603549, 2137216273,
  # Weak 65 (stage 12, feature 29)
  -150995201'i32, 2071191945, -1302151626, 536934335, -1059008937, 914128709, 1147328110, -268369925,
  # Weak 66 (stage 12, feature 128)
  -134509479'i32, 1610575703, -1342177289, 1861484541, -1107833788, 1577058173, -333558568, -136319041,
  # Weak 67 (stage 12, feature 70)
  -1'i32, 1060154476, -1090984524, -630918524, -539492875, 779616255, -839568424, -321,
  # Weak 68 (stage 12, feature 4)
  -269562385'i32, -285029906, -791084350, -17923776, 235286671, 1275504943, 1344390399, -966276889,
  # Weak 69 (stage 12, feature 76)
  17825984'i32, -747628419, 595427229, 1474759671, 575672208, -1684005538, 872217086, -1155858277,
  # Weak 70 (stage 12, feature 124)
  -336593039'i32, 1873735591, -822231622, -355795238, -470820869, -1997537409, -1057132384, -1015285005,
  # Weak 71 (stage 12, feature 54)
  -834212130'i32, -593694721, -322142257, -364892500, -951029539, -302125121, -1615106053, -79249765,
  # Weak 72 (stage 12, feature 95)
  1342144479'i32, 2147431935, -33554561, -47873, -855685912, -1, 1988052447, 536827383,
  # Weak 73 (stage 13, feature 39)
  1431368960'i32, -183437936, -537002499, -137497097, 1560590321, -84611081, -2097193, -513,
  # Weak 74 (stage 13, feature 120)
  -1645259691'i32, 2105491231, 2130706431, 1458995007, -8567536, -42483883, -33780003, -21004417,
  # Weak 75 (stage 13, feature 89)
  -612381022'i32, -505806938, -362027516, -452985106, 275854917, 1920431639, -12600561, -134221825,
  # Weak 76 (stage 13, feature 14)
  -805573153'i32, -161, -554172679, -530519488, -16779441, 2000682871, -33604275, -150997129,
  # Weak 77 (stage 13, feature 67)
  6192'i32, 435166195, 1467449341, 2046691505, -1608493775, -4755729, -1083162625, -71365637,
  # Weak 78 (stage 13, feature 86)
  -41689215'i32, -3281034, 1853357967, -420712635, -415924289, -270209208, -1088293113, -825311232,
  # Weak 79 (stage 13, feature 80)
  -117391116'i32, -42203396, 2080374461, -188709, -542008165, -356831940, -1091125345, -1073796897,
  # Weak 80 (stage 13, feature 75)
  -276830049'i32, 1378714472, -1342181951, 757272098, 1073740607, -282199241, -415761549, 170896931,
  # Weak 81 (stage 13, feature 55)
  -796075825'i32, -123166849, 2113667055, -217530421, -1107432194, -16385, -806359809, -391188771,
  # Weak 82 (stage 14, feature 71)
  -890246622'i32, 15525883, -487690486, 47116238, -1212319899, -1291847681, -68159890, -469829921,
  # Weak 83 (stage 14, feature 31)
  -1361180685'i32, -1898008841, -1090588811, -285410071, -1074016265, -840443905, 2147221487, -262145,
  # Weak 84 (stage 14, feature 40)
  1426190596'i32, 1899364271, 2142731795, -142607505, -508232452, -21563393, -41960001, -65,
  # Weak 85 (stage 14, feature 109)
  -201337965'i32, 10543906, -236498096, -746195597, 1974565825, -15204415, 921907633, -190058309,
  # Weak 86 (stage 14, feature 130)
  -595026732'i32, -656401928, -268649235, -571490699, -440600392, -133131, -358810952, -2004088646,
  # Weak 87 (stage 14, feature 66)
  941674740'i32, -1107882114, 1332789109, -67691015, -1360463693, -1556612430, -609108546, 733546933,
  # Weak 88 (stage 14, feature 49)
  -17114945'i32, -240061474, 1552871558, -82775604, -932393844, -1308544889, -532635478, -99042357,
  # Weak 89 (stage 14, feature 133)
  -655906006'i32, 1405502603, -939205164, 1884929228, -498859222, 559417357, -1928559445, -286264385,
  # Weak 90 (stage 14, feature 0)
  -335837777'i32, 1860677295, -90, -1946186226, 931096183, 251612987, 2013265917, -671232197,
  # Weak 91 (stage 14, feature 103)
  37769424'i32, -137772680, 374692301, 2002666345, -536176194, -1644484728, 807009019, 1069089930,
  # Weak 92 (stage 15, feature 43)
  -5505'i32, 2147462911, 2143265466, -4511070, -16450, -257, -201348440, -71333206,
  # Weak 93 (stage 15, feature 90)
  -136842268'i32, -499330741, 2015250980, -87107126, -641665744, -788524639, -1147864792, -134892563,
  # Weak 94 (stage 15, feature 104)
  -146800880'i32, -1780368555, 2111170033, -140904684, -16777551, -1946681885, -1646463595, -839131947,
  # Weak 95 (stage 15, feature 85)
  -832054034'i32, -981663763, -301990281, -578814081, -932319000, -1997406723, -33555201, -69206017,
  # Weak 96 (stage 15, feature 24)
  -118492417'i32, -1209026825, 1119023838, -1334313353, 1112948738, -297319313, 1378887291, -139469193,
  # Weak 97 (stage 15, feature 78)
  -1714382628'i32, -2353704, -112094959, -549613092, -1567058760, -1718550464, -342315012, -1074972227,
  # Weak 98 (stage 15, feature 5)
  -85219702'i32, 316836394, -33279, 1904970288, 2117267315, -260901769, -621461759, -88607770,
  # Weak 99 (stage 15, feature 11)
  -294654041'i32, -353603585, -1641159686, -50331921, -2080899877, 1145569279, -143132713, -152044037,
  # Weak 100 (stage 15, feature 32)
  1887453658'i32, -638545712, -1877976819, -34320972, -1071067983, -661345416, -583338277, 1060190561,
  # Weak 101 (stage 16, feature 122)
  -994063296'i32, 1088745462, -318837116, -319881377, 1102566613, 1165490103, -121679694, -134744129,
  # Weak 102 (stage 16, feature 68)
  -285233233'i32, -538992907, 1811935199, -369234005, -529, -20593, -20505, -1561401854,
  # Weak 103 (stage 16, feature 58)
  -1335245632'i32, 1968917183, 1940861695, 536816369, -1226071367, -570908176, 457026619, 1000020667,
  # Weak 104 (stage 16, feature 94)
  -1360318719'i32, -1979797897, -50435249, -18646473, -608879292, -805306691, -269304244, -17840167,
  # Weak 105 (stage 16, feature 87)
  2062765935'i32, -16449, -1275080721, -16406, 45764335, -1090552065, -772846337, -570464322,
  # Weak 106 (stage 16, feature 127)
  -536896021'i32, 1080817663, -738234288, -965478709, -2082767969, 1290855887, 1993822934, -990381609,
  # Weak 107 (stage 16, feature 3)
  -818943025'i32, 168730891, -293610428, -79249354, 669224671, 621166734, 1086506807, 1473768907,
  # Weak 108 (stage 16, feature 79)
  -68895696'i32, -67107736, -1414315879, -841676168, -619843344, -1180610531, -1081990469, 1043203389,
  # Weak 109 (stage 16, feature 116)
  -54002134'i32, -543485719, -2124882422, -1437445858, -115617074, -1195787391, -1096024366, -2140472445,
  # Weak 110 (stage 17, feature 132)
  -67113211'i32, 2003808111, 1862135111, 846461923, -2752, 2002237273, -273154752, 1937223539,
  # Weak 111 (stage 17, feature 62)
  1179423888'i32, -78064940, -611839555, -539167899, -1289358360, -1650810108, -892540499, -1432827684,
  # Weak 112 (stage 17, feature 23)
  -285212705'i32, -78450761, -656212031, -264050110, -27787425, -1334349961, -547662981, -135796924,
  # Weak 113 (stage 17, feature 77)
  341863476'i32, 403702016, -550588417, 1600194541, -1080690735, 951127993, -1388580949, -1153717473,
  # Weak 114 (stage 17, feature 22)
  -586880702'i32, -204831512, -100644596, -39319550, -1191150794, 705692513, 457203315, -75806957,
  # Weak 115 (stage 17, feature 72)
  -416546870'i32, 545911370, -673716192, -775559454, -264113598, 139424, -183369982, -204474641,
  # Weak 116 (stage 17, feature 50)
  -1026505020'i32, -589692154, -1740499937, -1563770497, 1348491006, -60710713, -1109853489, -633909413,
  # Weak 117 (stage 17, feature 108)
  -1448872304'i32, -477895040, -1778390608, -772418127, -1789923416, -1612057181, -805306693, -1415842113,
  # Weak 118 (stage 17, feature 92)
  407905424'i32, -582449988, 52654751, -1294472, -285103725, -74633006, 1871559083, 1057955850,
  # Weak 119 (stage 18, feature 81)
  4112'i32, -1259563825, -846671428, -100902460, 1838164148, -74153752, -90653988, -1074263896,
  # Weak 120 (stage 18, feature 1)
  -285216785'i32, -823206977, -1085589, -1081346, 1207959293, 1157103471, 2097133565, -2097169,
  # Weak 121 (stage 18, feature 121)
  -12465'i32, -536875169, 2147478367, 2130706303, -37765492, -866124467, -318782328, -1392509185,
  # Weak 122 (stage 18, feature 38)
  2147449663'i32, -20741, -16794757, 1945873146, -16710, -1, -8406341, -67663041,
  # Weak 123 (stage 18, feature 17)
  -155191713'i32, 866117231, 1651407483, 548272812, -479201468, -447742449, 1354229504, -261884429,
  # Weak 124 (stage 18, feature 100)
  -225319378'i32, -251682065, -492783986, -792341777, -1287261695, 1393643841, -11274182, -213909521,
  # Weak 125 (stage 18, feature 63)
  -382220122'i32, -2002072729, -51404800, -371201558, -923011069, -2135301457, -2066104743, -1042557441,
  # Weak 126 (stage 18, feature 101)
  -627353764'i32, -48295149, 1581203952, -436258614, -105268268, -1435893445, -638126888, -1061107126,
  # Weak 127 (stage 18, feature 118)
  -8399181'i32, 1058107691, -621022752, -251003468, -12582915, -574619739, -994397789, -1648362021,
  # Weak 128 (stage 18, feature 92)
  -348343812'i32, -1078389516, 1717960437, 364735981, -1783841602, -4883137, -457572354, -1076950384,
  # Weak 129 (stage 19, feature 10)
  -1976661318'i32, -287957604, -1659497122, -782068, 43591089, -453637880, 1435470000, -1077438561,
  # Weak 130 (stage 19, feature 131)
  -67110925'i32, 14874979, -142633168, -1338923040, 2046713291, -2067933195, 1473503712, -789579837,
  # Weak 131 (stage 19, feature 83)
  -272814301'i32, -1577073, -1118685, -305156120, -1052289, -1073813756, -538971154, -355523038,
  # Weak 132 (stage 19, feature 135)
  -2233'i32, -214486242, -538514758, 573747007, -159390971, 1994225489, -973738098, -203424005,
  # Weak 133 (stage 19, feature 115)
  -261031688'i32, -1330369299, -641860609, 1029570301, -1306461192, -1196149518, -1529767778, 683139823,
  # Weak 134 (stage 19, feature 64)
  -572993608'i32, -34042628, -417865, -111109, -1433365268, -19869715, -1920939864, -1279457063,
  # Weak 135 (stage 19, feature 36)
  -626275097'i32, -615256993, 1651946018, 805366393, 2016559730, -430780849, -799868165, -16580645,
  # Weak 136 (stage 19, feature 93)
  1354797300'i32, -1090957603, 1976418270, -1342502178, -1851873892, -1194637077, -1153521668, -1108399474,
  # Weak 137 (stage 19, feature 91)
  68157712'i32, 1211368313, -304759523, 1063017136, 798797750, -275513546, 648167355, -1145357350,
  # Weak 138 (stage 19, feature 107)
  -546318240'i32, -1628569602, -163577944, -537002306, -545456389, -1325465645, -380446736, -1058473386,
]

# ============================================================================
# Cascade Object
# ============================================================================

proc initFrontalfaceCascade*(): LbpCascade =
  ## Initialize and return the frontal face LBP cascade
  ## This cascade is converted from OpenCV's lbpcascade_frontalface.xml
  result = LbpCascade(
    windowW: FrontalfaceWindowW,
    windowH: FrontalfaceWindowH,
    nFeatures: FrontalfaceNFeatures,
    nWeaks: FrontalfaceNWeaks,
    nStages: FrontalfaceNStages,
    features: cast[ptr UncheckedArray[int8]](frontalfaceFeatures[0].unsafeAddr),
    weakFeatureIdx: cast[ptr UncheckedArray[uint16]](frontalfaceWeakFeatureIdx[0].unsafeAddr),
    weakLeftVal: cast[ptr UncheckedArray[float32]](frontalfaceWeakLeftVal[0].unsafeAddr),
    weakRightVal: cast[ptr UncheckedArray[float32]](frontalfaceWeakRightVal[0].unsafeAddr),
    weakSubsetOffset: cast[ptr UncheckedArray[uint16]](frontalfaceWeakSubsetOffset[0].unsafeAddr),
    weakNumSubsets: cast[ptr UncheckedArray[uint16]](frontalfaceWeakNumSubsets[0].unsafeAddr),
    subsets: cast[ptr UncheckedArray[int32]](frontalfaceSubsets[0].unsafeAddr),
    stageWeakStart: cast[ptr UncheckedArray[uint16]](frontalfaceStageWeakStart[0].unsafeAddr),
    stageNWeaks: cast[ptr UncheckedArray[uint16]](frontalfaceStageNWeaks[0].unsafeAddr),
    stageThreshold: cast[ptr UncheckedArray[float32]](frontalfaceStageThreshold[0].unsafeAddr),
  )

# Global cascade instance for convenience
let frontalfaceCascade* = initFrontalfaceCascade()
